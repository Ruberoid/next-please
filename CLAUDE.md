# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Описание проекта

"Next please" — браузерное расширение для Chrome (Manifest V3), которое автоматически переключает на следующее видео в YouTube Shorts, когда текущее подходит к концу.

## Архитектура

Проект состоит из двух файлов:

- `manifest.json` — манифест расширения Chrome (версия 3)
- `content.js` — content script, который внедряется на страницы YouTube Shorts

### Логика работы

Content script выполняет следующее:
1. Ищет элемент `<video>` на странице (с повторными попытками каждую секунду)
2. Запускает интервальный мониторинг (каждые 500ms) времени воспроизведения
3. Когда видео приближается к концу (за 0.5 секунды до окончания), кликает на кнопку "Следующее" (#navigation-button-down button)
4. Сбрасывает триггер при перезапуске видео (currentTime < 1)

## Тестирование и разработка

### Загрузка расширения в Chrome

1. Открыть `chrome://extensions/`
2. Включить "Режим разработчика" (Developer mode)
3. Нажать "Загрузить распакованное расширение" (Load unpacked)
4. Выбрать директорию проекта `/home/ruberoid/work/next-please`

### Тестирование

1. Открыть любое видео YouTube Shorts: `https://www.youtube.com/shorts/[video_id]`
2. Открыть DevTools (F12) → вкладка Console
3. Искать логи с префиксом `[Next please]`
4. Дождаться окончания видео и проверить автоматическое переключение

### Отладка

Все действия расширения логируются через `console.log` с префиксом `[Next please]`. Основные события:
- Поиск видео элемента
- Обнаружение видео
- Достижение конца видео
- Клик по кнопке "Следующее"

## Особенности кода

- Используется IIFE (Immediately Invoked Function Expression) для изоляции области видимости
- Флаг `triggered` предотвращает множественные клики в конце видео
- Проверка `video.duration && video.currentTime` необходима, т.к. эти значения могут быть undefined в начале загрузки
- Порог 0.5 секунды до конца позволяет переключиться плавно, не дожидаясь полного окончания
